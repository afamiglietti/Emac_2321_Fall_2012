# HelloWorld python script for the scripting framework

import time
from datetime import timedelta
from datetime import date 

def DateTimePython( ):
    """Prints the string 'Hello World(in Python)' into the current document"""
    #get the doc from the scripting context which is made available to all scripts
    model = XSCRIPTCONTEXT.getDocument()
    text = model.Text
    cursor = text.createTextCursor()
    theDay = date(2012, 8, 27)
    week = 1
    heading = "Week " + str(week) + '\n\n'
    while theDay < date(2012, 12, 12):
    	text.insertString( cursor, heading, 0 ) 
        now = theDay.strftime("%A %B %d") + '\n\n\n'
    	text.insertString( cursor, now, 0 )
	if theDay.weekday() == 2:
		increment = timedelta(days = 5)
		week = week + 1 			                
		heading = "Week " + str(week) + '\n\n'
	else:        
		increment = timedelta(days = 2)
		heading = ""
	theDay = theDay + increment
